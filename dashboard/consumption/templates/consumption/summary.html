{% extends 'consumption/layout.html' %}

{% block content %}

<h1></h1>
<body>
    <div id="app">
        <v-app id="inspire"> 
            <!-- <canvas id="totalchart"></canvas> -->
            <div id="totalchart"></div>
            <canvas id="averagechart"></canvas>
            <v-container>
                <v-card>
                    <v-card>
                        <v-data-table
                        :headers="headers"
                        :items="{{ user_data }}"
                        :items-per-page="100"
                        group-by="area"
                        :dense="true"
                        :multi-sort="true"
                    ></v-data-table>
                    </v-card>
                </v-card>
                
                
            </v-container>
        </v-app>
        
    </div>
    

    <script src="https://unpkg.com/vue"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script>
        var vm= new Vue({
            delimiters: ['[[',']]'],
            el: '#app',
            vuetify: new Vuetify(),
            data:{
              data:[],
              headers:[
                  {text:"id",value:"id"},
                  {text:"area", value:"area"},
                  {text:"tariff", value:"tariff"}
              ]
          },
          methods:{
            createChart: function(){
                var totalCtx = document.querySelector("#totalchart")
                var datetime = []
                "{% for d in data.datetime %}"
                datetime.push("{{ d }}")
                "{% endfor %}"
                var totalConfig = {
                    chart:{
                        type:"line",
                    },
                    series:[
                        {
                            name: "total",
                            data:"{{ data.total }}".split(","),
                        }
                    ],
                    xaxis:{
                        categories:datetime,
                    },
                    
                }
                var averageCtx = document.getElementById("averagechart").getContext("2d")
                var averageConfig = {
                    type:"line",
                    data:{
                        labels:datetime,
                        datasets:[
                            {
                                label: "average",
                                data:"{{ data.average }}".split(","),
                                backgroundColor:"rgba(153,255,51,0.4)"
                            },
                        ]
                    }
                }
                var totalChart = new ApexCharts(totalCtx,totalConfig)
                totalChart.render()
                var averageChart = new Chart(averageCtx,averageConfig)
            }
          },
          mounted: function (){
            this.createChart()
          },
        })
      </script>
</body>

{% endblock %}